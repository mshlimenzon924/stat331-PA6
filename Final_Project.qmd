---
title: "Final Project"
format: html
author: "Stolie Erickson, Mira Shlimenzon, Joseph Konat, Casey Avila"
self-contained: true
---

##Data Description
The two variables that we are interested in are the average daily income per capita (independent variable) and how it is related to CO2 emissions per capita (response variable).

**Income Data**
The income dataset contains information regarding each country's average daily household income based on a 2011 survey. These are measured in constant international dollars (PPP), converting the dollars to amounts that equalize the purchasing power across different currencies/regions. There does not appear to be NA values or a number that is replacing missing data, although our data cleaning will reveal more information regarding this. 

**CO2 Data**
The CO2 data set describes the consumption based CO2 emissions in million tonnes of CO2 per capita. These values are based on the Global Carbon Project 2021. 

**Hypothesis**
We anticipate that more economically developed countries (those with higher average incomes per capita) will be correlated with higher CO2 emissions compared to countries with lower average incomes per capita. 

<https://www.cgdev.org/media/who-caused-climate-change-historically#:~:text=Developed%20Countries%20Are%20Responsible%20for,Global%20Development%20%7C%20Ideas%20to%20Action>


```{r setup}
library(tidyverse)

co2 <- read_csv("co2.csv")
ipp <- read_csv("cpp.csv")
```

**Data Cleaning**
Upon initially looking through the CO2 data, we noticed that less economically developed countries in earlier years have repeated emission values for extended periods of time. We believe that it is unreasonable for CO2 emissions per capita to remain exactly the same for 30+ years for several rows. Under the assumption that predictive modeling was used to fill in data which was unknown dating back to 1800, we will be taking steps to clean it. In order to prevent our data from skewing, we are creating a function that will take in each row of the data set, and replace the emission values with NA’s until the emission initially changes. For example, since Australia has an emission value of 0 from 1800 to 1859, then changes in 1860 to .33, our function will sequence through the row and replace all of the 0’s with NA until 1859 (it will keep only the last 0 before the change) then the rest of the row will remain the same.


```{r}
clean_init_repeats <- function(row) {
  previous <- row[1]
  for (i in 2:length(row)) {
    if (previous == row[i]) {
      row[i - 1] <- NA
    }
  }
  return(row)
}
  
clean_init_repeats(co2[1])

```

```{r}
co2_long <- co2 %>%
  mutate(across(`1800`:`2020`, 
                ~ as.numeric(str_replace(.x, "−", "-")))) %>%
  pivot_longer(cols = `1800`:`2020`,
               names_to = "Year",
               values_to = "Emissions")
```
